---
- name: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ nginx –Ω–∞ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä—ã
  hosts: webservers
  become: yes
  tasks:
    - name: –û–±–Ω–æ–≤–∏—Ç—å –∫—ç—à –ø–∞–∫–µ—Ç–æ–≤
      apt:
        update_cache: yes
        cache_valid_time: 3600

    - name: –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å nginx
      apt:
        name: nginx
        state: present

    - name: –í–∫–ª—é—á–∏—Ç—å –∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–ª—É–∂–±—É nginx
      systemd:
        name: nginx
        state: started
        enabled: yes

    - name: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å nginx
      command: systemctl is-active nginx
      register: nginx_status
      changed_when: false

    - name: –°–æ–∑–¥–∞—Ç—å –∫–∞—Å—Ç–æ–º–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É
      copy:
        content: |
          <!DOCTYPE html>
          <html>
          <head>
            <title>{{ inventory_hostname }}</title>
            <style>
              body { font-family: Arial, sans-serif; text-align: center; padding: 50px; background: #f0f0f0; }
              .box { background: white; border-radius: 10px; padding: 30px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); max-width: 600px; margin: 0 auto; }
              h1 { color: #333; }
              .ip { color: #007bff; font-weight: bold; font-size: 1.2em; }
              .footer { margin-top: 20px; color: #777; font-size: 0.9em; }
            </style>
          </head>
          <body>
            <div class="box">
              <h1>üéâ –ü—Ä–∏–≤–µ—Ç —Å —Å–µ—Ä–≤–µ—Ä–∞ {{ inventory_hostname }}!</h1>
              <p class="ip">IP: {{ ansible_default_ipv4.address }}</p>
              <p class="footer">–î–∞—Ç–∞: {{ ansible_date_time.date }} | –í—Ä–µ–º—è: {{ ansible_date_time.time }}</p>
            </div>
          </body>
          </html>
        dest: /var/www/html/index.html
        mode: '0644'

    - name: –ü–æ–∫–∞–∑–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç
      debug:
        msg: "‚úÖ –°–µ—Ä–≤–µ—Ä {{ inventory_hostname }} –≥–æ—Ç–æ–≤! –°—Ç–∞—Ç—É—Å: {{ nginx_status.stdout }}"